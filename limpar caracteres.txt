Função personalizada limpar caracteres.


Essa função criei quando tive a necessidade de retirar do texto os caracteres  ’!@_-+-&#|?{}[]<>^%/\*$().,;:ÁÍÓÚÉÄÏÖÜËÀÌÒÙÈÃÕÂÎÔÛÊáíóúéäïöüëàìòùèãõâîôûêÇç e importar um arquivo texto para outro sistema que não aceitava esses caracteres.

Copie e cole o código para um módulo do VBA.

Function LimpaAcento(S As String) As String
Dim Acentos1, Acentos2, TMP, tmp2 As String
Dim i, Aux As Integer
Acentos1 = “‘!@_-+-&#|?{}[]<>^%/\*$().,;:ÁÍÓÚÉÄÏÖÜËÀÌÒÙÈÃÕÂÎÔÛÊáíóúéäïöüëàìòùèãõâîôûêÇç”
Acentos2 = ” AIOUEAIOUEAIOUEAOAIOUEaioueaioueaioueaoaioueCc”
tmp2 = “”
For i = 1 To Len(S)
Aux = InStr(1, Acentos1, Mid(S, i, 1), 0)
If (Aux <= 0) Then
TMP = Mid(S, i, 1)
Else
TMP = Mid(Acentos2, Aux, 1)
End If
tmp2 = tmp2 + TMP
Next i
LimpaAcento = tmp2
End Function